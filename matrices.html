<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>CalcPro ‚Äì Matrices ULTRA</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/mathjs@11.11.0/lib/browser/math.js"></script>

<style>
body{margin:0;background:#121212;color:white;font-family:Arial,sans-serif;}
header{text-align:center;padding:20px;font-size:24px;color:#60a5fa;font-weight:bold;}
.container{max-width:700px;margin:auto;background:#1e1e2f;padding:20px;border-radius:15px;box-shadow:0 0 25px rgba(0,0,0,.6);}
.matrix-box{display:grid;grid-template-columns:1fr 1fr;gap:15px;}
textarea{width:100%;height:120px;background:#0b0e1a;color:#60a5fa;border:none;border-radius:10px;padding:10px;font-size:15px;resize:none;}
.buttons{display:grid;grid-template-columns:repeat(auto-fit, minmax(120px,1fr));gap:15px;margin-top:20px;}
button{padding:15px;font-size:16px;border:none;border-radius:12px;cursor:pointer;background:#2563eb;color:white;font-weight:bold;transition:0.2s;}
button:hover{background:#3b82f6;transform:scale(1.05);}
.result{margin-top:15px;background:#0b0e1a;padding:15px;border-radius:10px;min-height:70px;white-space:pre-wrap;color:#60a5fa;font-size:16px;}
footer{text-align:center;margin-top:20px;color:#aaa;font-size:13px;}
table{border-collapse:collapse;}
td{border:1px solid #60a5fa;padding:6px;text-align:center;}
</style>
</head>

<body>
<header>üßÆ Matrices ULTRA</header>
<div class="container">
  <div class="matrix-box">
    <textarea id="A" placeholder="Matrice A&#10;Ex: 1 2&#10;3 4"></textarea>
    <textarea id="B" placeholder="Matrice B&#10;Ex: 5 6&#10;7 8"></textarea>
  </div>

  <div class="buttons">
    <button id="btnAdd">A + B</button>
    <button id="btnSub">A ‚àí B</button>
    <button id="btnMul">A √ó B</button>
    <button id="btnDet">det(A)</button>
    <button id="btnInv">A‚Åª¬π</button>
    <button id="btnTrans">A·µÄ</button>
  </div>

  <div class="result" id="result">R√©sultat‚Ä¶</div>
</div>
<footer>CalcPro ¬© Lebbar Yahya</footer>

<script>
// PARSE matrice (espaces, virgules, tabulations)
function parseMatrix(text){
  const rows = text.trim().split(/\n/);
  const matrix = rows.map(row=>{
    const nums = row.trim().split(/[\s,]+/).map(Number);
    if(nums.some(isNaN)) throw "Format incorrect"; // validation
    return nums;
  });

  // V√©rifier que toutes les lignes ont le m√™me nombre de colonnes
  const nCols = matrix[0].length;
  if(!matrix.every(r=>r.length === nCols)) throw "Toutes les lignes doivent avoir le m√™me nombre de colonnes";
  return math.matrix(matrix);
}

// AFFICHER matrice en tableau HTML
function showMatrix(mat){
  if(typeof mat==="number") return mat;
  const arr = mat._data || mat;
  let html="<table>";
  arr.forEach(r=>{
    html+="<tr>";
    r.forEach(c=>html+="<td>"+c+"</td>");
    html+="</tr>";
  });
  html+="</table>";
  return html;
}

function display(result){document.getElementById("result").innerHTML=showMatrix(result);}

// R√âCUP√âRATION DES √âL√âMENTS
const A = document.getElementById("A");
const B = document.getElementById("B");
const result = document.getElementById("result");

// FONCTIONS DES BOUTONS
document.getElementById("btnAdd").addEventListener("click",()=>{
  try{
    display(math.add(parseMatrix(A.value),parseMatrix(B.value)));
  }catch(e){result.innerText="‚ùå "+e;}
});

document.getElementById("btnSub").addEventListener("click",()=>{
  try{
    display(math.subtract(parseMatrix(A.value),parseMatrix(B.value)));
  }catch(e){result.innerText="‚ùå "+e;}
});

document.getElementById("btnMul").addEventListener("click",()=>{
  try{
    const MA = parseMatrix(A.value);
    const MB = parseMatrix(B.value);
    display(math.multiply(MA,MB));
  }catch(e){result.innerText="‚ùå "+e;}
});

document.getElementById("btnDet").addEventListener("click",()=>{
  try{
    const MA = parseMatrix(A.value);
    if(MA._size[0]!==MA._size[1]) throw "La matrice doit √™tre carr√©e";
    display(math.det(MA));
  }catch(e){result.innerText="‚ùå "+e;}
});

document.getElementById("btnInv").addEventListener("click",()=>{
  try{
    const MA = parseMatrix(A.value);
    if(MA._size[0]!==MA._size[1]) throw "La matrice doit √™tre carr√©e";
    display(math.inv(MA));
  }catch(e){result.innerText="‚ùå "+e;}
});

document.getElementById("btnTrans").addEventListener("click",()=>{
  try{
    display(math.transpose(parseMatrix(A.value)));
  }catch(e){result.innerText="‚ùå "+e;}
});
</script>
</body>
</html>
