<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>CalcPro IA</title>
<style>
  body { background: #111; color: #fff; font-family: Arial, sans-serif; display:flex; flex-direction:column; align-items:center; padding:50px; }
  #question { width: 400px; padding:10px; font-size:18px; }
  #reply { margin-top:20px; font-size:20px; color:#0f0; white-space:pre-line; }
  #suggestions { margin-top:10px; color:#0ff; }
</style>
</head>
<body>
<h1>CalcPro IA</h1>
<input type="text" id="question" placeholder="√âcris ton √©quation..." autofocus />
<div id="reply"></div>
<div id="suggestions"></div>

<script>
const input = document.getElementById("question");
const reply = document.getElementById("reply");
const suggestions = document.getElementById("suggestions");
let timeout;

// Fonction pour appeler le serveur
async function askAI(question) {
  try {
    const res = await fetch("http://localhost:3000/ask-ai", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ question })
    });
    const data = await res.json();
    reply.textContent = data.reply;

    // Suggestions basiques (offline)
    suggestions.textContent = "";
    if(question.includes("x")) {
      suggestions.textContent = "üí° Suggestions : Factoriser | D√©velopper | R√©soudre | D√©river | Int√©grer";
    }

  } catch (err) {
    reply.textContent = "Erreur serveur IA.";
  }
}

// D√©tecte en continu pendant que l‚Äôutilisateur tape
input.addEventListener("input", () => {
  clearTimeout(timeout);
  timeout = setTimeout(() => {
    const q = input.value.trim();
    if(q) askAI(q);
    else { reply.textContent=""; suggestions.textContent=""; }
  }, 300); // 300ms apr√®s la derni√®re frappe
});
</script>
</body>
</html>
