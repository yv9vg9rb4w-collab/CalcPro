<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>C.P.IA - Chat IA</title>
<style>
body {
    font-family: Arial, sans-serif;
    background: #1e1e1e;
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 50px;
}

#chatBox {
    width: 400px;
    max-width: 90%;
    height: 400px;
    background: #2e2e2e;
    padding: 10px;
    overflow-y: auto;
    border-radius: 10px;
    margin-bottom: 10px;
}

input[type="text"] {
    width: 300px;
    padding: 10px;
    border-radius: 5px;
    border: none;
    margin-right: 5px;
}

button {
    padding: 10px 15px;
    border: none;
    border-radius: 5px;
    background: #ff9500;
    color: #fff;
    cursor: pointer;
}

.message {
    margin: 5px 0;
}

.user { color: #4bd6ff; }
.ia { color: #ff9500; }
</style>
</head>
<body>

<h2>C.P.IA - Chat IA</h2>
<div id="chatBox"></div>
<input type="text" id="userInput" placeholder="Pose ta question...">
<button onclick="envoyer()">Envoyer</button>

<script>
let chatBox = document.getElementById('chatBox');

function ajouterMessage(message, type) {
    let msgDiv = document.createElement('div');
    msgDiv.className = type;
    msgDiv.textContent = message;
    msgDiv.style.margin = "5px 0";
    msgDiv.style.color = (type === 'user') ? "#4bd6ff" : "#ff9500";
    chatBox.appendChild(msgDiv);
    chatBox.scrollTop = chatBox.scrollHeight;
}

async function envoyer() {
    let userInput = document.getElementById('userInput');
    let question = userInput.value.trim();
    if(question === "") return;

    ajouterMessage(question, 'user');
    userInput.value = "";
    userInput.focus();

    try {
        let response = await fetch('http://127.0.0.1:3000/ask-ia', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ prompt: question })
        });

        let data = await response.json();
        ajouterMessage(data.text, 'ia');
    } catch (err) {
        ajouterMessage("Erreur : impossible de contacter C.P.IA.", 'ia');
    }
}
</script>

</body>
</html>
