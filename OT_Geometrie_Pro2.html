<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>CalcPro G√©o - Algorithmes 3D & 2D</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
    :root { --accent: #00ffcc; --bg: #0d0d0d; --card: #1a1a1a; }
    body { background: var(--bg); color: white; font-family: sans-serif; margin: 0; padding: 10px; touch-action: manipulation; }
    
    /* Layout Vertical pour Mobile - √âvite le blocage √† droite */
    .interface { display: flex; flex-direction: column; gap: 10px; }
    .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
    
    button { 
        background: var(--card); border: 1px solid #333; color: white; border-radius: 8px;
        padding: 12px 5px; font-weight: bold; font-size: 13px; cursor: pointer;
    }
    button:active { background: var(--accent); color: black; }
    .full { grid-column: span 2; border-color: #ff4d4d; color: #ff4d4d; }

    .titre-section { color: var(--accent); font-size: 11px; text-transform: uppercase; margin-top: 5px; grid-column: span 2; text-align: center; border-bottom: 1px solid #333; }

    /* Zone d'affichage */
    #ecran { 
        position: relative; width: 100%; height: 320px; background: #000; 
        border: 2px solid #222; border-radius: 12px; overflow: hidden; margin-top: 10px;
    }
    #canvas2D { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 10; pointer-events: none; }
    #container3D { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 5; }
    
    #definition { text-align: center; padding: 10px; color: var(--accent); font-size: 13px; min-height: 45px; }
</style>
</head>
<body>

<div class="interface">
    <div class="btn-grid">
        <button class="full" onclick="algoNettoyer()">üóëÔ∏è EFFACER TOUT</button>

        <div class="titre-section">Figures 2D</div>
        <button onclick="algo2D('carre')">CARR√â</button>
        <button onclick="algo2D('rect')">RECTANGLE</button>
        <button onclick="algo2D('equi')">√âQUILAT√âRAL</button>
        <button onclick="algo2D('iso')">ISOC√àLE</button>
        <button onclick="algo2D('sca')">SCAL√àNE</button>
        <button onclick="algo2D('cercle')">CERCLE</button>

        <div class="titre-section">Figures 3D</div>
        <button onclick="algo3D('cube')">CUBE</button>
        <button onclick="algo3D('sphere')">SPH√àRE</button>
        <button onclick="algo3D('cone')">C√îNE</button>
        <button onclick="algo3D('cylindre')">CYLINDRE</button>
        <button onclick="algo3D('pyramide')">PYRAMIDE</button>
        <button onclick="algo3D('tore')">TORE</button>
    </div>
</div>

<div id="ecran">
    <canvas id="canvas2D"></canvas>
    <div id="container3D"></div>
</div>

<div id="definition">S√©lectionnez une figure</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.159.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.159.0/examples/js/controls/OrbitControls.js"></script>

<script>
// --- INITIALISATION DES ALGORITHMES ---
const canvas = document.getElementById('canvas2D');
const ctx = canvas.getContext('2d');
const def = document.getElementById('definition');
const container = document.getElementById('container3D');

let scene, camera, renderer, controls, meshActuel = null;

function initG√©o() {
    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
    camera.position.z = 5;

    renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setSize(container.clientWidth, container.clientHeight);
    container.appendChild(renderer.domElement);

    const lumiere = new THREE.DirectionalLight(0xffffff, 1);
    lumiere.position.set(2, 2, 5);
    scene.add(lumiere, new THREE.AmbientLight(0x404040));

    controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;

    canvas.width = container.clientWidth;
    canvas.height = container.clientHeight;
    
    boucleRendu();
}

function algoNettoyer() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    if (meshActuel) { scene.remove(meshActuel); meshActuel = null; }
    def.textContent = "√âcran pr√™t.";
}

// --- ALGORITHMES 2D ---
function algo2D(type) {
    algoNettoyer();
    ctx.fillStyle = "#00ffcc";
    const x = canvas.width / 2;
    const y = canvas.height / 2;

    if (type === 'carre') {
        ctx.fillRect(x - 50, y - 50, 100, 100);
        def.textContent = "CARR√â : 4 c√¥t√©s √©gaux, angles droits.";
    } 
    else if (type === 'rect') {
        ctx.fillRect(x - 80, y - 40, 160, 80);
        def.textContent = "RECTANGLE : C√¥t√©s oppos√©s √©gaux.";
    }
    else if (type === 'cercle') {
        ctx.beginPath(); ctx.arc(x, y, 60, 0, Math.PI*2); ctx.fill();
        def.textContent = "CERCLE : Rayon constant sur 360¬∞.";
    }
    else if (type === 'equi') {
        ctx.beginPath();
        ctx.moveTo(x, y - 60); ctx.lineTo(x - 70, y + 40); ctx.lineTo(x + 70, y + 40);
        ctx.closePath(); ctx.fill();
        def.textContent = "√âQUILAT√âRAL : 3 c√¥t√©s √©gaux (angles 60¬∞).";
    }
    else if (type === 'iso') {
        ctx.beginPath();
        ctx.moveTo(x, y - 90); ctx.lineTo(x - 40, y + 50); ctx.lineTo(x + 40, y + 50);
        ctx.closePath(); ctx.fill();
        def.textContent = "ISOC√àLE : 2 c√¥t√©s √©gaux.";
    }
    else if (type === 'sca') {
        ctx.beginPath();
        ctx.moveTo(x - 20, y - 60); ctx.lineTo(x - 80, y + 50); ctx.lineTo(x + 100, y + 20);
        ctx.closePath(); ctx.fill();
        def.textContent = "SCAL√àNE : 3 c√¥t√©s et angles diff√©rents.";
    }
}

// --- ALGORITHMES 3D ---
function algo3D(type) {
    algoNettoyer();
    let geometrie;
    
    if (type === 'cube') geometrie = new THREE.BoxGeometry(2, 2, 2);
    else if (type === 'sphere') geometrie = new THREE.SphereGeometry(1.5, 32, 32);
    else if (type === 'cone') geometrie = new THREE.ConeGeometry(1.5, 3, 32);
    else if (type === 'cylindre') geometrie = new THREE.CylinderGeometry(1, 1, 3, 32);
    else if (type === 'pyramide') geometrie = new THREE.ConeGeometry(1.8, 2.5, 4);
    else if (type === 'tore') geometrie = new THREE.TorusGeometry(1, 0.4, 16, 100);

    const matiere = new THREE.MeshPhongMaterial({ color: 0x00ffcc, flatShading: true });
    meshActuel = new THREE.Mesh(geometrie, matiere);
    scene.add(meshActuel);
    def.textContent = type.toUpperCase() + " 3D : Faites pivoter avec le doigt.";
}

function boucleRendu() {
    requestAnimationFrame(boucleRendu);
    if (meshActuel) meshActuel.rotation.y += 0.01;
    controls.update();
    renderer.render(scene, camera);
}

window.addEventListener('resize', () => {
    renderer.setSize(container.clientWidth, container.clientHeight);
    camera.aspect = container.clientWidth / container.clientHeight;
    camera.updateProjectionMatrix();
    canvas.width = container.clientWidth;
    canvas.height = container.clientHeight;
});

initG√©o();
</script>
</body>
</html>