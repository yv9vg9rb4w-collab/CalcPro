<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>CalcPro | Outil Géométrie Pro</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root{
  --bg:#0f0f0f;
  --card:#1b1b1b;
  --accent:#00ffcc;
  --text:#ffffff;
  --muted:#aaaaaa;
}

body{
  margin:0; padding:20px;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
  background:var(--bg); color:var(--text);
}

header{text-align:center;margin-bottom:20px;}
header h1{margin:0;font-size:2em;color:var(--accent);}
header p{margin-top:5px;color:var(--muted);}

#controls{
  display:flex; flex-wrap:wrap; gap:10px; justify-content:center; margin-bottom:20px;
}
#controls button{
  background:var(--card); border:none; border-radius:12px;
  padding:10px 15px; color:var(--text); font-weight:bold;
  cursor:pointer; box-shadow:0 0 10px rgba(0,255,204,0.2);
  transition:0.2s ease;
}
#controls button:hover{
  transform:translateY(-3px) scale(1.05);
  box-shadow:0 0 20px rgba(0,255,204,0.35);
}

/* Canvas & container */
#canvas2D{position:relative; display:block; margin:auto; width:90%; max-width:800px; height:400px; background:#1b1b1b; border-radius:16px; box-shadow:0 0 20px rgba(0,255,204,0.3);}
.shape{position:absolute; cursor:move;}

/* Definition */
#definition{text-align:center;margin-top:10px;color:var(--accent);font-size:16px;}

/* Three.js */
#threejs-container{width:90%; max-width:700px; height:400px; margin:30px auto; border-radius:16px; box-shadow:0 0 25px rgba(0,255,204,0.3); background:#1b1b1b;}
</style>
</head>
<body>

<header>
<h1>Outil Géométrie CalcPro</h1>
<p>Figures 2D & Solides 3D – Calques interactifs</p>
</header>

<div id="controls">
  <strong>2D :</strong>
  <button onclick="addShape('carré')">Carré</button>
  <button onclick="addShape('rectangle')">Rectangle</button>
  <button onclick="addShape('cercle')">Cercle</button>
  <button onclick="addShape('triangle')">Triangle</button>
  <button onclick="addShape('losange')">Losange</button>
  <button onclick="addShape('parallélogramme')">Parallélogramme</button>
  <button onclick="addShape('trapèze')">Trapèze</button>

  <strong>3D :</strong>
  <button onclick="draw3DShape('cube')">Cube</button>
  <button onclick="draw3DShape('sphere')">Sphère</button>
  <button onclick="draw3DShape('cylindre')">Cylindre</button>
  <button onclick="draw3DShape('cône')">Cône</button>
  <button onclick="draw3DShape('pyramide')">Pyramide</button>
  <button onclick="draw3DShape('tore')">Tore</button>
</div>

<div id="canvas2D"></div>
<div id="definition">Sélectionne une forme pour voir sa définition</div>
<div id="threejs-container"></div>

<script src="https://cdn.jsdelivr.net/npm/three@0.159.0/build/three.min.js"></script>
<script>
// ==== 2D draggable shapes ====
const canvas2D = document.getElementById('canvas2D');
const def = document.getElementById('definition');

function addShape(type){
  const shape = document.createElement('div');
  shape.classList.add('shape');
  shape.style.top='100px';
  shape.style.left='100px';
  shape.style.background='var(--accent)';
  
  let size = 80;
  switch(type){
    case 'carré':
      shape.style.width=size+'px'; shape.style.height=size+'px';
      break;
    case 'rectangle':
      shape.style.width=(size*1.5)+'px'; shape.style.height=size+'px';
      break;
    case 'cercle':
      shape.style.width=size+'px'; shape.style.height=size+'px'; shape.style.borderRadius='50%';
      break;
    case 'triangle':
      shape.style.width='0'; shape.style.height='0';
      shape.style.borderLeft=(size/2)+'px solid transparent';
      shape.style.borderRight=(size/2)+'px solid transparent';
      shape.style.borderBottom=size+'px solid var(--accent)';
      break;
    case 'losange':
      shape.style.width=size+'px'; shape.style.height=size+'px';
      shape.style.transform='rotate(45deg)';
      break;
    case 'parallélogramme':
      shape.style.width=size*1.5+'px'; shape.style.height=size+'px';
      shape.style.transform='skewX(20deg)';
      break;
    case 'trapèze':
      shape.style.width=size*1.5+'px'; shape.style.height=size+'px';
      shape.style.clipPath='polygon(20% 0%, 80% 0%, 100% 100%, 0% 100%)';
      break;
  }

  // Show definition
  const definitions = {
    'carré':'Carré : quadrilatère avec côtés égaux et angles droits.',
    'rectangle':'Rectangle : quadrilatère avec côtés opposés égaux.',
    'cercle':'Cercle : ensemble de points équidistants d’un centre.',
    'triangle':'Triangle : polygone à trois côtés.',
    'losange':'Losange : quadrilatère avec 4 côtés égaux et angles non droits.',
    'parallélogramme':'Parallélogramme : quadrilatère avec côtés opposés parallèles.',
    'trapèze':'Trapèze : quadrilatère avec une paire de côtés parallèles.'
  };
  def.textContent = definitions[type];

  // Draggable
  let offsetX,offsetY,dragging=false;
  shape.addEventListener('mousedown',e=>{
    dragging=true;
    offsetX=e.offsetX; offsetY=e.offsetY;
  });
  window.addEventListener('mousemove',e=>{
    if(dragging){
      shape.style.left=(e.clientX-offsetX-canvas2D.getBoundingClientRect().left)+'px';
      shape.style.top=(e.clientY-offsetY-canvas2D.getBoundingClientRect().top)+'px';
    }
  });
  window.addEventListener('mouseup',()=>{dragging=false;});

  canvas2D.appendChild(shape);
}

// ==== 3D Three.js ====
const container = document.getElementById('threejs-container');
const scene = new THREE.Scene();
scene.background=new THREE.Color(0x1b1b1b);
const camera = new THREE.PerspectiveCamera(75,container.clientWidth/container.clientHeight,0.1,1000);
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(container.clientWidth,container.clientHeight);
container.appendChild(renderer.domElement);

const light = new THREE.DirectionalLight(0xffffff,1);
light.position.set(5,5,5); scene.add(light);
const ambientLight = new THREE.AmbientLight(0x404040); scene.add(ambientLight);
camera.position.z=5;
let current3D;

function draw3DShape(shape){
  if(current3D) scene.remove(current3D);
  let geometry;
  switch(shape){
    case 'cube': geometry=new THREE.BoxGeometry(2,2,2); break;
    case 'sphere': geometry=new THREE.SphereGeometry(1.5,32,32); break;
    case 'cylindre': geometry=new THREE.CylinderGeometry(1,1,3,32); break;
    case 'cône': geometry=new THREE.ConeGeometry(1.5,3,32); break;
    case 'pyramide': geometry=new THREE.ConeGeometry(1.5,3,4); break;
    case 'tore': geometry=new THREE.TorusGeometry(1,0.4,16,100); break;
  }
  const material=new THREE.MeshPhongMaterial({color:0x00ffcc,flatShading:true});
  current3D=new THREE.Mesh(geometry,material);
  scene.add(current3D);

  const definitions3D = {
    'cube':'Cube : solide à 6 faces carrées égales.',
    'sphere':'Sphère : ensemble de points équidistants d’un centre.',
    'cylindre':'Cylindre : solide avec bases circulaires parallèles.',
    'cône':'Cône : solide avec base circulaire et sommet unique.',
    'pyramide':'Pyramide : solide avec base polygonale et sommet unique.',
    'tore':'Tore : forme en anneau 3D.'
  };
  def.textContent=definitions3D[shape];
}

function animate(){
  requestAnimationFrame(animate);
  if(current3D) current3D.rotation.y+=0.01;
  renderer.render(scene,camera);
}
animate();
</script>
</body>
</html>