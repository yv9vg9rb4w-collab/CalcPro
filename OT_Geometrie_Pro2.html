<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>OT Géométrie CalcPro</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
<style>
body{
    font-family: Arial, sans-serif;
    background:#f4f4f4;
    text-align:center;
    margin:0;
    padding:0;
}
button{
    padding:10px 15px;
    margin:5px;
    font-size:16px;
    border:none;
    border-radius:6px;
    background:#4CAF50;
    color:#fff;
    cursor:pointer;
    transition:0.2s;
}
button:hover{
    background:#45a049;
}
canvas{
    margin-top:10px;
    border:1px solid #ccc;
    border-radius:6px;
}
#definition{
    margin-top:10px;
    font-weight:bold;
}
#result{
    margin-top:5px;
    font-size:17px;
}
</style>
</head>
<body>

<div style="margin-top:10px;">
<button onclick="show2D()">2D</button>
<button onclick="show3D()">3D</button>
</div>

<div id="options"></div>
<div id="definition"></div>
<div id="result"></div>

<script>

let scene,camera,renderer,currentObject,controls;

/* ========= MENU ========= */
function show2D(){
document.getElementById("options").innerHTML=`
<h3>Figures 2D</h3>
<button onclick="triangle()">Triangle</button>
<button onclick="square()">Carré</button>
<button onclick="rectangle()">Rectangle</button>
<button onclick="circle()">Cercle</button>
<button onclick="polygon(5)">Polygone 5 côtés</button>
<button onclick="polygon(6)">Polygone 6 côtés</button>
<button onclick="polygon(8)">Polygone 8 côtés</button>
<button onclick="polygon(10)">Polygone 10 côtés</button>
`;
}

function show3D(){
document.getElementById("options").innerHTML=`
<h3>Solides 3D</h3>
<button onclick="cube()">Cube</button>
<button onclick="box()">Pavé droit</button>
<button onclick="sphere()">Sphère</button>
<button onclick="cylinder()">Cylindre</button>
<button onclick="cone()">Cône</button>
<button onclick="pyramid()">Pyramide</button>
`;
}

/* ========= UTIL ========= */
function clearCanvas(){
const old=document.querySelector("canvas");
if(old) old.remove();
if(controls) controls=null;
}

/* ========= 2D ========= */
function baseCanvas(){
clearCanvas();
let c=document.createElement("canvas");
c.width=400; c.height=400;
document.body.appendChild(c);
return c.getContext("2d");
}

function triangle(){
let ctx=baseCanvas();
ctx.beginPath();
ctx.moveTo(200,50);
ctx.lineTo(50,350);
ctx.lineTo(350,350);
ctx.closePath();
ctx.stroke();
document.getElementById("definition").innerHTML="Triangle : figure à 3 côtés.";
let a=300,b=300,c_side=282.84;
let s=(a+b+c_side)/2;
let area=Math.sqrt(s*(s-a)*(s-b)*(s-c_side));
let perimeter=a+b+c_side;
document.getElementById("result").innerHTML=`Surface ≈ ${area.toFixed(2)}, Périmètre ≈ ${perimeter.toFixed(2)}`;
}

function square(){
let ctx=baseCanvas();
ctx.strokeRect(100,100,200,200);
document.getElementById("definition").innerHTML="Carré : 4 côtés égaux et 4 angles droits.";
let side=200;
document.getElementById("result").innerHTML=`Surface = ${side*side}, Périmètre = ${4*side}`;
}

function rectangle(){
let ctx=baseCanvas();
ctx.strokeRect(80,150,250,120);
document.getElementById("definition").innerHTML="Rectangle : 4 angles droits.";
document.getElementById("result").innerHTML=`Surface = ${250*120}, Périmètre = ${2*(250+120)}`;
}

function circle(){
let ctx=baseCanvas();
ctx.beginPath();
ctx.arc(200,200,150,0,2*Math.PI);
ctx.stroke();
document.getElementById("definition").innerHTML="Cercle : points à égale distance d’un centre.";
let r=150;
document.getElementById("result").innerHTML=`Surface ≈ ${(Math.PI*r*r).toFixed(2)}, Périmètre ≈ ${(2*Math.PI*r).toFixed(2)}`;
}

function polygon(sides){
let ctx=baseCanvas();
let cx=200,cy=200,r=150;
ctx.beginPath();
for(let i=0;i<sides;i++){
let angle=(i*2*Math.PI/sides)-Math.PI/2;
let x=cx+r*Math.cos(angle);
let y=cy+r*Math.sin(angle);
if(i===0) ctx.moveTo(x,y);
else ctx.lineTo(x,y);
}
ctx.closePath();ctx.stroke();
let sideLength=100; 
let area=(sides*sideLength*sideLength)/(4*Math.tan(Math.PI/sides));
let perimeter=sides*sideLength;
document.getElementById("definition").innerHTML=`Polygone régulier à ${sides} côtés.`;
document.getElementById("result").innerHTML=`Surface ≈ ${area.toFixed(2)}, Périmètre = ${perimeter}`;
}

/* ========= 3D ========= */
function init3D(){
clearCanvas();
scene=new THREE.Scene();
camera=new THREE.PerspectiveCamera(75,1,0.1,1000);
renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(400,400);
document.body.appendChild(renderer.domElement);
camera.position.z=10;
let light=new THREE.PointLight(0xffffff,1);
light.position.set(5,5,5);
scene.add(light);
controls=new THREE.OrbitControls(camera,renderer.domElement);
controls.enableDamping=true;controls.dampingFactor=0.05;
controls.enableZoom=true;controls.enablePan=true;
}

function animate(){requestAnimationFrame(animate);if(currentObject) currentObject.rotation.x+=0.005; if(controls) controls.update(); renderer.render(scene,camera);}

function cube(){init3D();let w=3; let geo=new THREE.BoxGeometry(w,w,w); let mat=new THREE.MeshStandardMaterial({color:0x00ffff}); currentObject=new THREE.Mesh(geo,mat); scene.add(currentObject); animate(); document.getElementById("definition").innerHTML="Cube : 6 faces carrées égales."; document.getElementById("result").innerHTML=`Volume = ${(w*w*w).toFixed(2)}, Surface = ${(6*w*w).toFixed(2)}`;}
function box(){init3D();let w=3,h=4,d=2;let geo=new THREE.BoxGeometry(w,h,d); let mat=new THREE.MeshStandardMaterial({color:0xff8800});currentObject=new THREE.Mesh(geo,mat);scene.add(currentObject);animate();document.getElementById("definition").innerHTML="Pavé droit : 6 faces rectangulaires.";document.getElementById("result").innerHTML=`Volume = ${(w*h*d).toFixed(2)}, Surface = ${(2*(w*h+w*d+h*d)).toFixed(2)`;}
function sphere(){init3D();let r=2;let geo=new THREE.SphereGeometry(r,32,32);let mat=new THREE.MeshStandardMaterial({color:0x00ffcc});currentObject=new THREE.Mesh(geo,mat);scene.add(currentObject);animate();document.getElementById("definition").innerHTML="Sphère : tous points à égale distance du centre.";document.getElementById("result").innerHTML=`Volume ≈ ${(4/3*Math.PI*r*r*r).toFixed(2)}, Surface ≈ ${(4*Math.PI*r*r).toFixed(2)}`;}
function cylinder(){init3D();let r=2,h=4;let geo=new THREE.CylinderGeometry(r,r,h,32);let mat=new THREE.MeshStandardMaterial({color:0xaa00ff});currentObject=new THREE.Mesh(geo,mat);scene.add(currentObject);animate();document.getElementById("definition").innerHTML="Cylindre : deux bases circulaires parallèles.";document.getElementById("result").innerHTML=`Volume ≈ ${(Math.PI*r*r*h).toFixed(2)}, Surface ≈ ${(2*Math.PI*r*h+2*Math.PI*r*r).toFixed(2)}`;}
function cone(){init3D();let r=2,h=4;let geo=new THREE.ConeGeometry(r,h,32);let mat=new THREE.MeshStandardMaterial({color:0xff0000});currentObject=new THREE.Mesh(geo,mat);scene.add(currentObject);animate();document.getElementById("definition").innerHTML="Cône : base circulaire et sommet.";let volume=(1/3*Math.PI*r*r*h);let surface=(Math.PI*r*(r+Math.sqrt(h*h+r*r)));document.getElementById("result").innerHTML=`Volume ≈ ${volume.toFixed(2)}, Surface ≈ ${surface.toFixed(2)}`;}
function pyramid(){init3D();let w=3,h=4;let geo=new THREE.ConeGeometry(w,h,4);let mat=new THREE.MeshStandardMaterial({color:0x009900});currentObject=new THREE.Mesh(geo,mat);scene.add(currentObject);animate();document.getElementById("definition").innerHTML="Pyramide : base polygonale et sommet.";let volume=(1/3*w*w*h);let surface=(w*w+2*w*Math.sqrt((w/2)*(w/2)+h*h));document.getElementById("result").innerHTML=`Volume ≈ ${volume.toFixed(2)}, Surface ≈ ${surface.toFixed(2)}`;}

</script>
</body>
</html>