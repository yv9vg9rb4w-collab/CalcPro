<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Calcul Intégrale Numérique</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:Arial;margin:20px;}
input{padding:8px;margin:5px;width:100px;}
button{padding:8px;margin:5px;}
#result{margin-top:10px;font-weight:bold;}
</style>
</head>
<body>

<h2>Intégrale numérique ∫ f(x) dx</h2>

<input id="fx" placeholder="f(x)">
<input id="a" placeholder="a">
<input id="b" placeholder="b">
<button onclick="calculIntegrale()">Calculer ∫ f(x) dx</button>

<div id="result">Résultat : </div>

<script>
// Fonction pour parser f(x) simple
function parseFunction(f){
    f = f.replace(/(\d)x/g,"$1*x");    // 2x → 2*x
    f = f.replace(/\^/g,"**");          // x^2 → x**2
    f = f.replace(/racin/gi,"Math.sqrt");
    f = f.replace(/π/gi,"Math.PI");
    f = f.replace(/e/gi,"Math.E");
    f = f.replace(/sin/gi,"Math.sin");
    f = f.replace(/cos/gi,"Math.cos");
    f = f.replace(/tg|tan/gi,"Math.tan");
    f = f.replace(/abs/gi,"Math.abs");
    return f;
}

function buildFunction(expr){
    let parsed = parseFunction(expr);
    return new Function('x','return '+parsed);
}

// Calcul intégrale numérique (méthode des trapèzes)
function calculIntegrale(){
    let fx = document.getElementById('fx').value;
    let a = parseFloat(document.getElementById('a').value);
    let b = parseFloat(document.getElementById('b').value);
    if(!fx || isNaN(a) || isNaN(b)){
        document.getElementById('result').innerText = "Veuillez saisir f(x) et bornes correctes.";
        return;
    }
    let f = buildFunction(fx);
    let n = 1000; // nombre de trapèzes
    let h = (b-a)/n;
    let sum = 0;
    for(let i=0;i<n;i++){
        let x0 = a + i*h;
        let x1 = a + (i+1)*h;
        sum += 0.5*(f(x0)+f(x1))*h;
    }
    document.getElementById('result').innerText = "Résultat ∫ f(x) dx ≈ " + sum.toFixed(5);
}
</script>

</body>
</html>
